# Larval Export MPAs

This repository provides the code to the study "Investigating effects of larval export from marine protected areas on fisheries using a global bioeconomic size-spectrum model". Briefly, we couple Lagrangian particle tracking to simulate passive larval movement with the global, spatially-resolved bioeconomic trophic size-spectrum model BOATS to estimate fish biomass and harvest. We then explore a 30âœ•30 MPA scenario that maximises economic benefit to test how much incorporating larval movement in a marine ecosystem model could offset the projected loss to fisheries upon MPA implementation. 
<br>
The code can be divided into four main sections:
<br>
* **Particle Tracking:** Preprocessing scripts for particle tracking can be found in Analysis/Notebooks and Analysis/PythonScripts. Near-global particle tracking is done with [Parcels](https://oceanparcels.org/#whatisparcels) by [Delandmeter and van Sebille (2019)](https://www.geosci-model-dev.net/12/3571/2019/gmd-12-3571-2019.html), performed with Analysis/Movement/PythonScripts/HPCParticleTrackingScript.py and requires a high perfomance computer. 
* **Calculating the transition matrix with movement probabilities:** The output of the particle tracking was processed to monthly transition matrices in R using the scripts in Analysis/Movement/RScripts/ProbabilityMatrix, specifically the script Calculate_ProbMatPTGlobalCompile25Y.R.
* **Global bioeconomic modelling simulations:** We used the publicly available BiOeconomic mArine Trophic Size-spectrum model ([BOATS](https://github.com/obeg-boats)) by Carozza et al. ([2016](https://earthsystemdynamics.org/wp-content/uploads/2018/05/Carozza-GMD-2016-BOATS.pdf), [2017](https://earthsystemdynamics.org/wp-content/uploads/2018/05/Carozza-PLoS-2017-BOATS.pdf)) to simulate whether egg/larval movement can offset lost fishing following MPA implementation. The version of BOATS including egg/larval movement can be found in Analysis/BOATS/sneubert-boats_v1 with instructions on how to run the model in the doc folder. Running BOATS as available here also requires a high performance computer. 
* **Analysis of simulations:** BOATS outputs were analysed in MATLAB using the scripts available in prepareOutput_SN.mat and plotting_scripts_SN.mat. The output was further analysed in R with the scripts in Analysis/Movement/RScripts/AnalysisBOATSoutput using a Generalised Linear Model (GLM folder) and by assessing the changes in individual Large Marine Ecosystems (LME folder).
